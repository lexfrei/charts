suite: test transmission chart
templates:
  - statefulset.yaml
  - service.yaml
  - pvc-config.yaml
  - ingress.yaml
  - serviceaccount.yaml
tests:
  - it: should create all resources with default values
    asserts:
      - isKind:
          of: StatefulSet
        template: statefulset.yaml
      - isKind:
          of: Service
        template: service.yaml
      - isKind:
          of: PersistentVolumeClaim
        template: pvc-config.yaml
      - isKind:
          of: Ingress
        template: ingress.yaml
      - isKind:
          of: ServiceAccount
        template: serviceaccount.yaml

  - it: should set correct image
    template: statefulset.yaml
    asserts:
      - equal:
          path: spec.template.spec.containers[0].image
          value: linuxserver/transmission:4.0.6

  - it: should create service with correct ports
    template: service.yaml
    asserts:
      - contains:
          path: spec.ports
          content:
            name: http
            port: 9091
            targetPort: http
            protocol: TCP
      - contains:
          path: spec.ports
          content:
            name: torrent-tcp
            port: 51413
            targetPort: torrent-tcp
            protocol: TCP
      - contains:
          path: spec.ports
          content:
            name: torrent-udp
            port: 51413
            targetPort: torrent-udp
            protocol: UDP
